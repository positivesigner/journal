Namespace Mx
    Public Class MxText
        Public Class FileName
            <System.Diagnostics.DebuggerHidden()>
            Public Function dAppendEXT(ur_ext As String) As FileName
                dAppendEXT = Me
                If ur_ext.StartsWith(".") = False Then
                    ur_ext = "." & ur_ext
                End If

                Me.FilePath &= ur_ext
            End Function 'dAppendEXT

            <System.Diagnostics.DebuggerHidden()>
            Public Function dAppendFileGroup(ur_text As String, Optional ur_separator As String = "_") As FileName
                dAppendFileGroup = Me
                Me.Name = Me.FileGroup & ur_separator & ur_text & Me.Ext
            End Function 'dAppendFileGroup
            
            <System.Diagnostics.DebuggerHidden()>
            Public Function dNowFileGroupYMDHMS(Optional ur_separator As String = "_") As FileName
                dNowFileGroupYMDHMS = Me
                Me.dAppendFileGroup(Now().ToString("yyyy\mMM\dddthh\mmm\sss").Replace("P12", "N12").Replace("A12", "A00").ToLower, ur_separator)
            End Function 'dNowFileGroupYMDHMS

            <System.Diagnostics.DebuggerHidden()>
            Public Function dTempFileName() As FileName
                dTempFileName = Me
                Me.d(glbl.gWindowsFS.GetRandomFileName.Replace(".", mt))
            End Function 'dTempFileName

            Public Property Ext() As String
                <System.Diagnostics.DebuggerHidden()>
                Get
                    Ext = System.IO.Path.GetExtension(Me.FilePath)
                End Get

                <System.Diagnostics.DebuggerHidden()>
                Set(value As String)
                    Me.wEXT(value)
                End Set
            End Property 'Ext

            Public Property FileGroup() As String
                <System.Diagnostics.DebuggerHidden()>
                Get
                    FileGroup = System.IO.Path.GetFileNameWithoutExtension(Me.FilePath)
                End Get

                <System.Diagnostics.DebuggerHidden()>
                Set(value As String)
                    Me.Name = value & Me.Ext
                End Set
            End Property 'FileGroup
            
            <System.Diagnostics.DebuggerHidden()>
            Public Function gCopy() As FileName
                gCopy = New FileName(Me)
            End Function 'gCopy

            <System.Diagnostics.DebuggerHidden()>
            Public Function wEXT(ur_ext As String) As FileName
                wEXT = Me
                Dim strFILE_NAME = Me.FileGroup
                If Left(ur_ext, 1) <> "." Then
                    ur_ext = "." & ur_ext
                End If 'ur_ext

                Me.wParentDir.d(strFILE_NAME & ur_ext)
            End Function 'wEXT

            <System.Diagnostics.DebuggerHidden()>
            Public Function Wrap(ur_path As String) As FileName
                Wrap = Me
                Me.FilePath = mt
                Call Me.d(ur_path)
            End Function 'Wrap
        End Class 'FileName
    End Class 'MxText-FileName
End Namespace 'Mx
